# GitLab Token Exporter Bash

![GitLab](https://img.shields.io/badge/GitLab-%23181717.svg?style=flat&logo=gitlab&logoColor=white)
![Prometheus](https://img.shields.io/badge/Prometheus-E6522C?style=flat&logo=Prometheus&logoColor=white)
![Shell Script](https://img.shields.io/badge/Shell_Script-%23121011.svg?style=flat&logo=gnu-bash&logoColor=white)

–°–∫—Ä–∏–ø—Ç –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å—Ä–æ–∫–æ–≤ –¥–µ–π—Å—Ç–≤–∏—è —Ç–æ–∫–µ–Ω–æ–≤ GitLab –≤ —Ñ–æ—Ä–º–∞—Ç–µ Prometheus.

## üìã –û–ø–∏—Å–∞–Ω–∏–µ
–°–∫—Ä–∏–ø—Ç —Å–æ–±–∏—Ä–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ:
- –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö —Ç–æ–∫–µ–Ω–∞—Ö –¥–æ—Å—Ç—É–ø–∞
- –ü—Ä–æ–µ–∫—Ç–Ω—ã—Ö —Ç–æ–∫–µ–Ω–∞—Ö
- –ì—Ä—É–ø–ø–æ–≤—ã—Ö —Ç–æ–∫–µ–Ω–∞—Ö
- –í—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ, –ø—Ä–∏–≥–æ–¥–Ω–æ–º –¥–ª—è —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫ Prometheus.

## ‚ú® –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —Ç–æ–∫–µ–Ω–æ–≤ GitLab
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ —Ç–æ–∫–µ–Ω–æ–≤ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å/–ø—Ä–æ–µ–∫—Ç/–≥—Ä—É–ø–ø–∞)
- –†–∞—Å—á–µ—Ç:
  - –î–Ω–µ–π –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è
  - –í—Ä–µ–º–µ–Ω–∏ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
  - –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –±–µ—Å—Å—Ä–æ—á–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤ (expiry_days=9999)

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Bash 4.0+
- `curl`
- `jq`
- –î–æ—Å—Ç—É–ø –∫ GitLab API (–≤–µ—Ä—Å–∏—è 13.0+)

### –ó–∞–ø—É—Å–∫
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
export GITLAB_URL="https://gitlab.example.com"
export API_TOKEN="your-access-token"

# –ó–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞
./gitlab_token_exporter.sh

# –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ –≤ Prometheus:
# gitlab_token_expiry_days{name="ci-bot-token", type="project", owner="android-app", last_used="2023-10-25"} 87
# gitlab_token_script_time{name="gitlab_token_script_time", type="script"} 12